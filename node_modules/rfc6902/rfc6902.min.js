var require=function(r){return this[r.split("/").slice(1).join("/")]};!function(r){var t=function(r,t){for(var e=[],n=0,o=Math.min(r.length,t.length);o>n;n++)e.push([r[n],t[n]]);return e},e=function(r,e){return r.length!==e.length?!1:t(r,e).every(function(r){return o(r[0],r[1])})},n=function(r,t){var n=Object.keys(r),i=Object.keys(t);return e(n,i)?n.every(function(e){return o(r[e],t[e])}):!1},o=r.equal=function(r,t){return r===t?!0:Array.isArray(r)&&Array.isArray(t)?e(r,t):Object(r)===r&&Object(t)===t?n(r,t):!1}}(this.equal={}),function(r){var t=r.MissingError=function(r){this.path=r};t.prototype.toString=function(){return"Value required at path: "+this.path};var e=r.InvalidOperationError=function(r){this.op=r};e.prototype.toString=function(){return"Invalid operation: "+this.op};var n=r.TestError=function(r,t){this.found=r,this.wanted=t};n.prototype.toString=function(){return"Test failed: "+this.found+" != "+this.wanted}}(this.errors={}),function(r){var t=function(r){return r.replace(/~1/g,"/").replace(/~0/g,"~")},e=function(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")},n=r.Pointer=function(r){this.tokens=r||[""]};n.parse=function(r){var e=r.split("/").map(t);if(""!==e[0])throw new Error("Invalid JSON Pointer: "+r);return new n(e)},n.prototype.toString=n.prototype.toJSON=function(){return this.tokens.map(e).join("/")},n.prototype.evaluate=function(r){for(var t=null,e=null,n=1,o=this.tokens.length;o>n;n++)t=r,e=this.tokens[n],r=(t||{})[e];return{parent:t,key:e,value:r}},n.prototype.push=function(r){this.tokens.push(r)},n.prototype.add=function(r){var t=this.tokens.concat(String(r));return new n(t)}}(this.pointer={}),function(r){{var t=require("./pointer"),e=(require("./errors"),require("./equal").equal),n=function(r,t){return Array.prototype.push.apply(r,t)},o=function(r,t){var e={};for(var n in r)e[n]=1;for(var o in t)delete e[o];return Object.keys(e)},i=function(r){var t={};r.forEach(function(r){for(var e in r)t[e]=(t[e]||0)+1});var e=r.length;for(var n in t)t[n]<e&&delete t[n];return Object.keys(t)},a=function(r,t,n){var o={"0,0":{operations:[],cost:0}},i=function(a,u){var p=o[[a,u]];if(void 0===p){if(e(r[a-1],t[u-1]))p=i(a-1,u-1);else{var s=[];a>0&&s.push({dist:i(a-1,u),type:"deletion"}),u>0&&s.push({dist:i(a,u-1),type:"insertion"}),a>0&&u>0&&s.push({dist:i(a-1,u-1),type:"substitution"});var v=s.sort(function(r,t){return r.dist.cost-t.dist.cost})[0],c=[];if("deletion"===v.type)c.push({op:"remove",path:n.add(a-1)});else if("insertion"===v.type){var f=u-1,h=n.add(f<r.length?f:"-");c.push({op:"add",path:h,value:t[u-1]})}else c.push({op:"replace",path:n.add(u-1),value:t[u-1]});p={operations:v.dist.operations.concat(c),cost:v.dist.cost+1}}o[[a,u]]=p}return p},a=i(r.length,t.length);return a.operations},u=a,p=function(r,t,e){var a=[];return o(r,t).forEach(function(r){a.push({op:"remove",path:e.add(r)})}),o(t,r).forEach(function(r){a.push({op:"add",path:e.add(r),value:t[r]})}),i([r,t]).forEach(function(o){n(a,v(r[o],t[o],e.add(o)))}),a},s=function(r,t,n){var o=[];return e(r,t)||o.push({op:"replace",path:n,value:t}),o},v=function(r,t,e){return Array.isArray(r)&&Array.isArray(t)?u(r,t,e):r===Object(r)&&t===Object(t)?p(r,t,e):s(r,t,e)};r.diff=function(r,e){var n=new t.Pointer,o=v(r,e,n);return o.forEach(function(r){r.path=r.path.toString()}),o}}}(this.diff={}),function(r){{var t=require("./pointer"),e=require("./errors"),n=require("./equal").equal,o=function(r,t,e){Array.isArray(r)?"-"==t?r.push(e):r.splice(t,0,e):r[t]=e},i=function(r,t){Array.isArray(r)?r.splice(t,1):delete r[t]},a={add:function(r,n){var i=t.Pointer.parse(n.path).evaluate(r);return void 0===i.parent?new e.MissingError(n.path):o(i.parent,i.key,n.value)},remove:function(r,n){var o=t.Pointer.parse(n.path).evaluate(r);return void 0===o.value?new e.MissingError(n.path):void i(o.parent,o.key)},replace:function(r,n){var o=t.Pointer.parse(n.path).evaluate(r);return void 0===o.value?new e.MissingError(n.path):void(o.parent[o.key]=n.value)},move:function(r,n){var a=t.Pointer.parse(n.from).evaluate(r);if(void 0===a.value)return new e.MissingError(n.from);var u=t.Pointer.parse(n.path).evaluate(r);return void 0===u.parent?new e.MissingError(n.path):(i(a.parent,a.key),void o(u.parent,u.key,a.value))},copy:function(r,n){var a=t.Pointer.parse(n.from).evaluate(r);if(void 0===a.value)return new e.MissingError(n.from);var u=t.Pointer.parse(n.path).evaluate(r);return void 0===u.parent?new e.MissingError(n.path):(i(a.parent,a.key),void o(u.parent,u.key,a.value))},test:function(r,o){var i=t.Pointer.parse(o.path).evaluate(r),a=n(i.value,o.value);return a?void 0:new e.TestError(i.value,o.value)}};r.patch=function(r,t){return t.map(function(t){var n=a[t.op];return void 0===n?new e.InvalidOperationError(t.op):n(r,t)})}}}(this.patch={});